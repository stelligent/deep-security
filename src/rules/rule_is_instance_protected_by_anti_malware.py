from src.rules.rule import Rule


class RuleIsInstanceProtectedByAntiMalware(Rule):
    def _do_check(self, details):
        if 'On, Real Time'.lower() in details.overall_anti_malware_status.lower() or \
                'On, Security Update In Progress, Real Time'.lower() in details.overall_anti_malware_status.lower():
            self._compliance = 'COMPLIANT'
        else:
            self._compliance = 'NON_COMPLIANT'

        self._compliance_msg = 'Anti-Malware status: {}'.format(details.overall_anti_malware_status)
